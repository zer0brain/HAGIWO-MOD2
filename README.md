HAGIWO‑MOD2 — Open modular sound modules for Seeed XIAO RP2350
==============================================================

HAGIWO‑MOD2 is a hardware/firmware concept for small, swappable sound modules (instruments, percussions, FX) built around the Seeed Studio XIAO RP2350. This repository contains a set of example modules and a build setup. Each module lives in its own folder and is compiled via a dedicated PlatformIO environment.

Most of the source code was generated by AI. Although tested, things may still be experimental. Use at your own risk—and feel free to design your own module behavior.

Contents
- What is MOD2 (concept)
- Quick start
- Features & hardware
- Hardware I/O map 
- Module index (with env names and paths)
	- See also `MODULES.md` for a detailed index and how to add new modules
- Build & upload
- For developers (programming model)
- Troubleshooting
- Third‑party components
- License

What is MOD2 (concept)
----------------------
MOD2 is a minimal front‑panel and I/O standard for compact synth/FX modules. The firmware defines the musical behavior; the panel controls and inputs are general‑purpose. A “module” in this repo is just a small program that reads inputs and produces audio to the PWM output.

Quick start
-----------
1) Install VS Code and the PlatformIO extension.
2) Open this folder in VS Code.
3) In PlatformIO, select an environment (for example `zer0_cowbell`).
4) Build, Upload, then open the Serial Monitor at 115200 baud.

Features & hardware
- Target: Seeed Studio XIAO RP2350 (Arduino core via Seeed platform)
- Modules include percussions, synth voices, drones, noise/FX, speech, and more
- Lightweight per‑module builds using PlatformIO `build_src_filter`

Hardware I/O map (neutral)
- POT1: A0 — analog input (0..1023). Meaning is defined by the module.
- POT2: A1 — analog input (0..1023). Meaning is defined by the module.
- POT3: A2 — analog input (0..1023). Meaning is defined by the module.
- IN1:  GPIO7 — digital input. Edge/level semantics are module‑defined.
- IN2:  GPIO0 — digital input. Auxiliary use is module‑defined.
- OUT:  GPIO1 — PWM audio output (10‑bit; 0..1023). Mid ≈ 511/512 when idle.
- LED:  GPIO5 — digital output. Purpose is module‑defined.
- BUTTON: GPIO6 — digital input (use pull‑up). Purpose is module‑defined.

Analog‑shared CV on A2 (POT3)
- Many panels tie the CV jack to POT3 (A2) via a passive mix, so firmware reads a single combined analog value (pot + external CV). Software cannot separate these sources without extra hardware.
- You may invert the reading for ergonomics (e.g., `value = 1023 - analogRead(A2)`), but this is optional—document your choice in the module header.

Module index
------------

For a complete, evolving list with add‑your‑own instructions, see `MODULES.md`.
The index contains examples across “HAGIWO” and “zer0” series. Treat them as reference implementations—your own modules can map controls and behaviors freely as long as they stick to the I/O pins above.

Build & upload
--------------
- Build one environment at a time. See `platformio.ini` for the complete list.
- Typical baud rate: 115200.
- Artifacts: `.elf` and `.bin` are always produced; `.uf2` requires `picotool`.

For developers (programming model)
----------------------------------
- Framework: Arduino on RP2350. Audio is generated via PWM on GPIO1 with a 10‑bit wrap (1023). Idle output should sit at mid‑rail (~512) to avoid clicks.
- Common pattern: build a short audio buffer (e.g., 4096 samples) on trigger and stream it from an ISR using linear interpolation. Keep the ISR minimal; do heavy work outside with IRQs masked.
- Concurrency: mark ISR‑shared variables as `volatile`; debounce the button; use LED for status only if it helps the UX you define.
- Persistence: If you need it, use Arduino EEPROM emulation (`begin/put/get/commit`).
- Design freedom: POT/IN1/IN2/BTN/LED semantics are entirely up to your module. Document them at the top of your `main.cpp`.
- More guidance: See `docs/AI_MOD2_INSTRUCTIONS.md` and the machine‑readable `docs/AI_MOD2_PROMPT.yml` to bootstrap new modules (human or AI generated).

Troubleshooting
- UF2 not generated: Install `picotool` or just use the `.bin` with your uploader. PlatformIO still finishes successfully.
- Library fetch: For speech (SAM), the library is pulled via `lib_deps` from GitHub. If you need reproducibility, pin a commit using `#<commit-sha>`.
- WSL/paths: On Windows with WSL, use paths like `/mnt/d/...` when running PlatformIO from a Linux shell.

Third‑party components
- SAM – Software Automatic Mouth (arduino‑SAM) by Phil Schatzmann
	- Upstream: https://github.com/pschatzmann/arduino-SAM
	- Status: Reverse‑engineered/Abandonware; no clear OSS license. Consumed only as external dependency.
	- Details: See `THIRD_PARTY.md`.

License
- CC0‑1.0 Public Domain Dedication (see `LICENSE`).
- Most source files include a header noting AI‑assisted generation.